## 5. 運算優先順序的陷阱

在 C 語言中，運算子的優先順序會影響表達式的計算結果，因此需要注意運算優先順序的陷阱。以下是一些常見的陷阱和解決方法：

1. 記得加括號

在表達式中，可以使用括號改變運算的優先順序。如果不加括號，容易出現計算錯誤的情況。例如：

```c
int a = 2, b = 3, c = 4;
int d = a + b * c; // 等於 14
```

上面的表達式，由於乘法的優先順序比加法高，所以先計算 b*c，再加上 a，最後得到 14。如果想要先計算 a+b，再乘以 c，則需要加上括號：

```c
int d = (a + b) * c; // 等於 20
```

2. 注意除法的精度問題

在 C 語言中，除法運算的結果可能會有精度問題。例如，計算 5/2 的結果會是 2，而不是 2.5。如果需要得到準確的結果，可以將其中一個操作數轉換為浮點數類型：

```c
int a = 5, b = 2;
double c = (double)a / b; // 等於 2.5
```

3. 不要忘記加上後綴

在 C 語言中，後綴運算子的優先順序比較低，容易被忽略。例如，如果要對一個變量進行累加，應該使用後綴運算子 ++：

```c
int a = 1;
int b = a++; // b等於1，a等於2
```

如果使用前綴運算子 ++，則會先對 a 進行累加，再賦值給 b，得到不同的結果：

```c
int a = 1;
int b = ++a; // b等於2，a等於2
```

4. 注意類型轉換

在 C 語言中，不同類型之間的運算可能會導致類型轉換，需要注意轉換的結果是否符合預期。例如，下面的表達式會導致整數類型轉換為浮點數類型：

```c
int a = 2, b = 3;
double c = a / b; // 等於 0.0
```

可以將其中一個操作數轉換為浮點數類型，避免類型轉換導致的精度損失：

```c
double c = (double)a / b; // 等於 0.666667
```

總之，熟悉運算子的優先順序和類型轉換規則，加上恰當的括號和後綴運算子，可以避免運算優先順序的陷阱。