## 6. 函數的參數傳遞的陷阱

函數的參數傳遞是C語言中一個常見但也容易產生陷阱的機制。以下是幾個常見的陷阱：

1. 陣列的參數傳遞：如果函數的參數是一個陣列，那麼實際上傳遞的是陣列的第一個元素的地址。在函數中，可以透過指標加上偏移量來訪問陣列的其他元素。

例如，下面的程式碼定義了一個陣列 a，然後調用函數 foo，傳遞陣列 a 給函數。

```c
void foo(int a[]) {
   a[0] = 1;
}

int main() {
   int a[10] = {0};
   foo(a);
   printf("%d\n", a[0]);
}
```

此時，函數 foo 中修改的是陣列第一個元素的值，也就是 a[0] = 1，因此函數執行完畢後會輸出 1。如果在 foo 函數中嘗試訪問陣列 a 的第 10 個元素 a[9]，那麼可能會造成程式錯誤。

2. 指標的參數傳遞：如果函數的參數是一個指標變數，那麼實際上傳遞的是該指標變數的值，也就是一個地址。在函數中，如果需要修改指標的值，可以透過指標的指標來實現。

例如，下面的程式碼定義了一個指標變數 p，然後調用函數 foo，傳遞指標變數 p 給函數。

```c
void foo(int **p) {
   *p = NULL;
}

int main() {
   int a = 0;
   int *p = &a;
   foo(&p);
   printf("%p\n", p);
}
```

此時，函數 foo 中修改了指標變數 p 的值，使其指向了空指標，因此在 main 函數中輸出 p 的值會得到 NULL。

3. 數值的參數傳遞：如果函數的參數是一個數值變數，那麼實際上傳遞的是該變數的值。在函數中修改該變數的值，不會改變原始變數的值。

例如，下面的程式碼定義了一個數值變數 a，然後調用函數 foo，傳遞數值變數 a 給函數。

```c
void foo(int x) {
   x++;
}

int main() {
   int a = 0;
   foo(a);
   printf("%d\n", a);
}
```

此時，在 foo 函數中增加了變數 x 的值，但是並沒有改變原始變數 a 的值，因此在 main 函數中輸出 a 的值依然是 0。