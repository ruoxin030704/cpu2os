## 2. 動態記憶體管理的陷阱

動態記憶體管理是 C 語言中非常重要的一個議題。在使用動態記憶體的時候需要注意一些陷阱：

1. 忘記釋放記憶體
當使用 malloc 或者 calloc 函數在堆區配置內存後，需要使用 free 函數釋放這段區域的記憶體。如果忘記釋放記憶體，就可能會導致記憶體洩漏以及程式崩潰等錯誤。

2. 使用 uninitialized 記憶體
malloc 和 calloc 函數配置的內存可能包含任意值，使用這些值可能會導致程式錯誤。建議使用 memset 函數將剛剛配置的內存初始化為 0。

3. Overflow 和 Underflow
指針是 C 語言中非常重要的資料型別，但是指針的使用需要格外小心。當操作指針的時候，如果超出了它所指向的區域範圍，就可能會發生 overflow 和 underflow 的錯誤。

4. 指針丟失
當使用指針動態配置記憶體的時候，容易發生指針丟失的錯誤。當你把指針重新指向一個新的區域時，原先指向的區域就會變成「丟失」狀態。這樣的話，就會導致原先配置的內存無法被釋放，從而導致記憶體洩漏。

範例：

```c
int main() {
  int *ptr = malloc(10 * sizeof(int)); // 配置 10 個整數的空間
  if (ptr == NULL) { // 確認是否配置成功
    return 0;
  }
  
  // 將配置的內存初始化為 0
  memset(ptr, 0, 10 * sizeof(int));
  
  // 使用指針訪問記憶體的時候，需要小心
  ptr[11] = 10; // 這樣就超出了 ptr 所指向的區域範圍，將會導致 overflow 錯誤
  
  // 要注意釋放內存，否則會導致記憶體洩漏
  free(ptr);
  
  return 0; 
}
```