# 第三章：指標和陣列

## 指標的基本概念和使用

在 C 語言中，指標是一個非常重要的概念，它可以用來實現動態記憶體分配、函數參數傳遞、陣列訪問等操作。指標是一個保存記憶體地址的變數，可以通過解引用操作符（*）訪問指向的記憶體。

指標的基本概念包括：

1. 取址運算符（&）：用來取得變數的記憶體地址。
2. 解引用運算符（*）：用來訪問指標所指向的記憶體內容。
3. 空指標（NULL）：一個特殊的指標值，表示不指向任何記憶體位置。

指標變數可以通過聲明來定義，例如：

```cpp
int *p;  // 定義一個指向 int 型變數的指標變數 p

```

指標還可以指向陣列的元素，例如：

```cpp
int a[10]; // 定義一個包含 10 個 int 型元素的陣列
int *p;    // 定義一個指向 int 型變數的指標變數 p
p = &a[0]; // 將指標變數 p 指向 a[0] 的位置

```

指標還可以通過指標算術運算進行偏移，例如：

```cpp
p++; // 將指標變數 p 指向下一個 int 型元素的位置
```

這樣可以方便地訪問陣列的不同元素。

## 陣列的基本概念和使用

陣列是 C 語言中的一種資料結構，可以用來存儲一系列相同資料型別的元素。陣列中的元素可以通過索引訪問，索引從 0 開始，一直到陣列大小減 1。

### 創建陣列

在 C 語言中，可以使用以下語法來聲明和初始化陣列：

```cpp
type array_name[array_size];
type array_name[array_size] = {value0, value1, ..., valueN};
```


### 訪問陣列元素

可以使用索引運算符 [] 來訪問陣列元素，如下所示：

```cpp
array_name[index]
```

其中，array_name 是陣列的名稱，index 是要訪問的元素的索引。索引的範圍從 0 到陣列大小減 1。

以下是一些訪問陣列元素的範例：

```cpp
int numbers[5] = {1, 2, 3, 4, 5};
double values[10];
values[0] = 1.0;
values[1] = 2.0;
values[2] = 3.0;
printf("numbers[2] = %d\n", numbers[2]);  // 輸出 3
printf("values[0] = %f\n", values[0]);  // 輸出 1.000000
```

## 陣列作為函數參數

在 C 語言中，可以將陣列作為函數的參數傳遞，如下所示：

```cpp
return_type function_name(type array_name[]);
```


或者：

```cpp
return_type function_name(type *array_name);
```


其中，type 是陣列元素的資料型別，array_name 是陣列的名稱。


## 指標和陣列的關係

指標和陣列在 C 語言中密切相關，因為陣列名稱本身就是一個指向陣列首元素的指標。

當我們使用陣列名稱時，實際上是在使用指向陣列首元素的指標。例如，考慮以下陣列：

```cpp
int arr[5] = {1, 2, 3, 4, 5};
```

我們可以使用陣列名稱 arr 來訪問陣列元素，例如 arr[0] 表示第一個元素，arr[1] 表示第二個元素，以此類推。但實際上，arr 是一個指向陣列首元素的指標，因此也可以使用指標運算符 * 來訪問陣列元素，例如 *arr 表示第一個元素，*(arr + 1) 表示第二個元素，以此類推。

此外，指標和陣列在參數傳遞和函式返回值中也有密切關係。當我們將陣列作為函式的參數傳遞時，實際上是將陣列的首元素的地址傳遞給函式，因此函式中可以使用指標來訪問陣列元素。同樣地，當函式返回陣列時，實際上是返回陣列的首元素的地址，因此返回值可以使用指標來處理。

## 字串和字元陣列

在 C 語言中，字串是一個以 null 結尾的字元陣列，也就是說，字串是由多個字元組成，並以 '\0' 字元（ASCII 碼為 0）結尾。例如，以下是一個字串的定義：

```cpp
char str[] = "hello";
```

在這個例子中，str 是一個字元陣列，它的值是 'h', 'e', 'l', 'l', 'o', '\0'。注意，這裡沒有指定陣列大小，編譯器會自動計算所需的空間大小。

可以使用字元陣列中的索引來訪問字串中的單個字元。例如，str[0] 表示字串中的第一個字元 'h'。

另外，還可以使用 C 語言的標準函式庫中的函式來處理字串，例如：

* strlen(str)：返回字串的長度（不包括結尾的 '\0'）。
* strcpy(dest, src)：將源字串 src 複製到目標字串 dest。
* strcat(dest, src)：將源字串 src 連接到目標字串 dest 的末尾。
* strcmp(str1, str2)：比較兩個字串是否相等。
需要注意的是，使用這些函式時要確保傳遞的字元陣列有足夠的空間，否則可能會發生緩衝區溢出等問題。

此外，由於字串本質上是一個字元陣列，因此也可以像其他陣列一樣使用指標來訪問。例如，可以使用以下代碼打印出字串中的每個字元：

```cpp
char str[] = "hello";
char *ptr = str;

while (*ptr != '\0') {
    printf("%c ", *ptr);
    ptr++;
}
```

## 指標的高級應用

指標是 C 語言中非常重要的一個概念，它可以用來訪問、操作和傳遞資料。在本節中，我們將介紹指標的一些高級應用。

### 指標和函式
在 C 語言中，指標和函式密切相關。在 C 語言中，函式的名稱實際上是一個指向函式的指標，可以將函式的地址賦值給一個指標變數，然後使用這個指標變數來調用函式。例如：

```cpp
#include <stdio.h>

void say_hello() {
    printf("Hello!\n");
}

int main() {
    void (*pf)() = say_hello;  // 將函式的地址賦值給指標變數 pf
    pf();  // 使用指標變數調用函式
    return 0;
}
```

在上面的代碼中，我們定義了一個無參數的函式 say_hello()，然後定義了一個指向無參數、無返回值的函式的指標變數 pf，並將 say_hello() 函式的地址賦值給 pf，最後使用 pf() 調用函式。

### 指標和結構體

在 C 語言中，結構體可以包含多個不同類型的成員變數，可以使用指標來訪問結構體中的成員變數。例如：

```cpp
#include <stdio.h>

struct Point {
    int x;
    int y;
};

int main() {
    struct Point p = {1, 2};
    struct Point *pp = &p;  // 定義一個指向結構體的指標變數 pp，並將其指向結構體 p
    pp->x = 3;  // 使用指標訪問結構體中的成員變數
    pp->y = 4;
    printf("(%d, %d)\n", p.x, p.y);  // 輸出結果為 (3, 4)
    return 0;
}
```

在上面的代碼中，我們定義了一個結構體 Point，包含兩個成員變數 x 和 y，然後定義了一個結構體指針變數 pp，並將其指向結構體 p，最後使用指標訪問結構體中的成員 x, y。
