## 第5章　文件和目錄操作

## 5.1 檔案存取權限
Unix/Linux 作業系統是多使用者系統，為了保護檔案與系統的安全，Unix 系統中設定每一個檔案的存取權限，讓每一個使用者只能存取其具有權限的檔案。在Unix/Linux中，根據檔案所隸屬的群組和檔案所有者的身份，分別對檔案的存取權限進行控制。以下是一個檔案的權限和控制權限的方式：

* r：讀取權限
* w：寫入權限
* x：執行權限

範例：權限字串 `rwxrw-r--`

* 第 1 ~ 3 個字元代表的是檔案所有者所具備的權限
* 第 4 ~ 6 個字元代表的是與檔案所有者在同一群組中的使用者所具備的權限
* 第 7 ~ 9 個字元代表的是其他使用者的權限

### 修改檔案權限 chmod
```bash
chmod [-R] xyz file...
```

其中的 xyz 為 u(檔案擁有者)、g(同群組使用者)、o(其他使用者) 或 a(所有使用者) 之一，亦可使用數字來表示權限，對應關係如下：

```
rwx = 2^2 + 2^1 + 2^0 = 4 + 2 + 1 = 7
rw- = 2^2 + 2^1 + 2^0 = 4 + 2 + 0 = 6
r-x = 2^2 + 2^1 + 2^0 = 4 + 0 + 1 = 5
r-- = 2^2 + 2^1 + 2^0 = 4 + 0 + 0 = 4
```

示例：

```bash
# 將檔案 file1.txt 變更為 a=rwx 同時不更動子目錄
chmod a=rwx file1.txt

# 將檔案 file3.txt 及檔案 file4.txt 變更為全部人可讀可寫
chmod 666 file3.txt file4.txt

# 將檔案 file5.txt 及檔案 file6.txt 變更為自身可讀寫，與同群組者和其他使用者可讀
chmod 644 file5.txt file6.txt

# 將目錄dir1和目錄dir2及其下所有檔案，變更為自身具有rwx權限，同群組和其他使用者具有r權限
chmod -R 755 dir1 dir2
```

## 5.2 檔案與目錄操作命令
### touch
`touch` 命令用於修改檔案的時間戳記或建立一個空的檔案，常用的選項如下：

* -a：僅修改存取時間
* -m：僅修改修改時間
* -c：若檔案不存在，不建立檔案
* -d：設定檔案的日期和時間

示例：
```bash
# 新增一個空檔案
touch file1.txt

# 修改檔案時間
touch -a file1.txt
```

### cp
`cp` 命令用於複製檔案或目錄，可選項目如下：

* -a, --archive：此為常用的選項，於備份時尤其有用，它會保留原始的檔案建立時間、修改時間和權限，且不依據原始檔案屬性而調整複本設定
* -r, -R, --recursive：遞迴處理，將指定目錄下的所有檔案及子目錄一併處理
* -i：交互式複製，在覆蓋之前提示使用者
* -u：若指定檔案在目的地檔案已存在與目的地檔案比較，則僅在指定檔案比目的地檔案新，或是目的地檔案不存在時，才進行複製
* -l：建立硬鍵結(created hard links) 只有用在檔案上才有這個選項

示例：
```bash
# 將 file1 複製到 ~ 的文件夾內
cp file1 ~/.

# 複製整個目錄
cp -R source_dir target_dir
```
### rm
`rm` 命令用於刪除檔案或目錄，可選項目如下：

* -f, -R：強制刪除，加入後連目錄一併刪除
* -i：互動模式，
* -v：顯示詳細資訊，詳細列出每個檔案

示例：
```bash
# 刪除檔案 file1.txt
rm file1.txt

# 刪除目錄，會彈出確認提示
rm -iR dir1

# 彈出提示刪除文件 file2.txt，做決定後會提示檔案已刪除
rm -i file2.txt
```

### mv
`mv` 命令用於移動檔案，亦可用於更名等操作，可選項目如下：

* -f：強制移動，目標檔案存在時，強制覆蓋
* -i：交互式移動，在覆蓋之前提示使用者
* -v：顯示詳細資訊，詳細列出每個檔案

示例：
```bash
# 將檔案 file1.txt 移動到 dir1 目錄下
mv file1.txt dir1/.

# 將檔案 file2.txt 最為 file3.txt
mv file2.txt file3.txt
```
### mkdir
`mkdir` 命令用於建立目錄，其常用選項如下：

* -m：設定目錄建立時的權限
* -p：可以一次性建立多級目錄，若上層目錄不存在則建立
* -v：顯示詳細資訊，列出每個建立的目錄

示例：
```bash
# 建立一個目錄
mkdir dir1

# 建立目錄dir2及其下的所有子目錄
mkdir -p dir2/subdir1/subdir2/subdir3

# 建立目錄，設定權限
mkdir -m 777 dir3

# 建立目錄，列出詳細資訊
mkdir -v dir4
```

### rmdir
`rmdir` 命令用於刪除空目錄，常用的選項如下：

* -p：可以刪除多層空目錄
* -v：顯示詳細資訊，列出每個被刪除的目錄

示例：
```bash
# 刪除空目錄 dir1
rmdir dir1

# 刪除所有空目錄 
rmdir -p dir1/subdir1/subdir2/subdir3

# 刪除目錄，列出詳細資訊
rmdir -v dir2 
```
## 5.3 find 命令
`find` 命令用於在目錄層次結構中搜索檔案，常用選項如下：

* -name：按檔案名稱來搜尋檔案
* -type：按檔案類型來搜尋檔案，類型有檔案(-f)、目錄(-d)、字符裝置檔案(-c)、塊裝置檔案(-b)等
* -mtime n：按檔案的修改時間來搜尋檔案，n 是 24 小時的整數倍，-mtime +n 表示查詢 n 天之前的檔案，-mtime n 表示查詢時間為 n 天當天的檔案，-mtime -n 表示查詢 n 天之內的檔案
* -size n：設定檔案的大小，如 +100k 表示大於 100KB，-100k 表示小於 100KB，100k 表示正好是 100KB 的檔案

示例：
```bash
# 按名稱查找檔案file1.txt
find /etc -name file1.txt

# 查找修改時間是 24 小時之內的 php 檔案
find /var -name "*php" -mtime -1

# 找出大於 100KB 的文件
find /home -size +100k

# 將搜索到的文件移動到目錄dir1下
find /var -name "*.txt" -type f -exec mv {} dir1 \;
```
以上就是 Unix/Linux 中文件和目錄操作的基本命令，讀者可以在實踐中深入體會。