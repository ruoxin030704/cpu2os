## 3.5 C語言的函數

在C語言中，函數是程式的基本組成部分，它能夠讓程式較為清晰、結構化，並具有可重用性。在C語言中，函數可用來執行一段特定的工作，也可被多次呼叫，並回傳一個結果。本節將介紹C語言中函數的定義、呼叫和傳參。

#### 函數的定義
C語言中函數的定義需包括以下要素：
* 傳回值類型：函數所傳回的數據類型。
* 函數名稱：函數的名稱。
* 傳入參數：傳入函數中的變數，可設置預設值和不同數量的參數。
* 函數主體：在花括號中定義要執行的程式碼。

函數定義的基本語法如下所示：

```c
傳回值類型 函數名稱(傳入參數){
    函數主體;
}
```

接下來，我們以一個簡單的例子來介紹函數定義。這裡我們定義一個名為`add`的函數，用於兩個數字相加：


```c
int add(int a, int b){
    int result;
    result = a + b;
    return result;
}
```

在上面的例子中，我們定義了一個名為`add`的函數，它有兩個`int`型的傳入參數，用來傳入要相加的兩個數字。它的傳回值類型為`int`型。在函數主體中，我們將傳入的兩個數字相加，並將結果保存在局部變數`result`中，最後通過關鍵字`return`返回`result`，這樣函數`add`就完成了它的任務。

#### 函數的呼叫
當需要使用一個函數時，我們可以通過函數名稱以及傳入的參數來呼叫函數。C語言中函數的呼叫形式如下所示：

```c
函數名稱(參數);
```

在函數定義之後，我們可以在主函數中，通過函數名稱來呼叫函數。繼續上面的例子，我們將在主函數中呼叫`add`函數。

```c
#include <stdio.h>

int add(int a, int b);

int main(){
    int num1 = 5, num2 = 8, sum;
    sum = add(num1, num2);
    printf("The sum of %d and %d is %d\n", num1, num2, sum);
    return 0;
}

int add(int a, int b){
    int result;
    result = a + b;
    return result;
}
```

#### 函數的傳參
在C語言中，函數的參數傳遞有兩種方式：值傳遞和指針傳遞。

值傳遞是指將變量的值複製一份，作為參數傳入函數。在函數內部操作該參數時，改變的只是複製出的一份值，原變量的值並不會受到影響。

```c
int foo(int x){
    return x * 2;
}

int main(){
    int x = 3;
    printf("%d\n", foo(x));
    return 0;
}
```

在這段程式中，`foo`函數以值傳遞的方式接收了變數`x`，在函數內部，`x`被複製了一份作為參數，`x`的值並沒有被改變。

另一種傳參方式是指針傳遞。指針是 C 語言中非常重要的一種資料類型，它代表了一個記憶體位置。當我們以指針傳遞參數時，實際傳入函數的是一個記憶體位置，函數內部可以通過這個記憶體位置來修改變數的值，這樣相比於值傳遞，可以更有效地使用記憶體空間。

```c
void swap(int *x, int *y){
    int temp = *x;
    *x = *y;
    *y = temp;
}

int main(){
    int x = 1, y = 2;
    printf("Before swap: x = %d, y = %d\n", x, y);
    swap(&x, &y);
    printf("After swap: x = %d, y = %d\n", x, y);
    return 0;
}
```

在這段程式中，`swap`函數以指針傳遞的方式接收了變數`x`和`y`，在函數內部，通過指針可以訪問到這兩個變數，進行值的交換。在`main`函數中，通過`&`取得這兩個變數的記憶體位置，傳入`swap`函數即可。

#### 函數指針
C語言中還支持函數指針，即指向函數的指針。和普通指針一樣，函數指針保存的是一個記憶體位置，該位置指向一個函數。通過函數指針，我們可以在程式執行過程中動態地決定要呼叫哪個具體的函數，這樣可以實現更加靈活的程式設計。

函數指針定義的基本語法如下：

```c
ret_type (*pointer_name)(parameters);
```

其中，ret_type 為函數傳回值的資料型別；pointer_name 為函數指針的名稱；parameters 為函數傳入的參數資料型別。

下面是一個簡單的例子，在程式中我們定義了一個`echo`函數和一個指向`echo`函數的指針`fp`，通過`fp`指針呼叫`echo`函數：

```c
#include<stdio.h>

void echo(int c){
    printf("The input is %d\n", c);
}

int main(){
    void (*fp)(int);
    fp = &echo;
    fp(42);
    return 0;
}
```

在上面的程式中，首先定義了一個`echo`函數，該函數用於輸出一個整數。接著，在`main`函數中，定義一個指針變數`fp`，並將它指向`echo`函數的記憶體位置（也可以使用簡化寫法`fp = echo`）。最後通過指針變數`fp`調用`echo`函數，因為`fp`指向`echo`函數，所以順利輸出了整數42。

#### 總結
在本節中，我們介紹了C語言中函數的定義、呼叫、以及參數傳遞的方式。在日常程式開發中，函數是一個重要的工具，能夠方便地實現代碼的模組化、以及程式碼的重用性。認識函數是成為一名優秀的程式員不可缺少的必修技能。