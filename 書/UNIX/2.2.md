## 2.2 文件描述符和I/O重定向

在 UNIX 系统中，一切皆文件，包括外部设备、内存、进程和网络等，这些文件都可以被看作是放在一个文件系统中的文件。

文件描述符（file descriptor）是用来标识一个被进程打开的文件的整数。在 UNIX 环境中，文件描述符是一个非负整数，通常使用 int 类型表示。在一个 UNIX 进程的文件描述符表中，它们就像是一个简单的数组，其中包含了指向所有当前打开文件的指针。文件描述符是同一进程内部使用，不能被其他进程直接访问。

I/O 重定向是 UNIX 中十分重要的概念之一，它指的是将进程标准输入、输出或错误输出从默认的设备重定向到其他设备或文件。引入 I/O 重定向之后，我们可以通过输出重定向将进程的输出写入到文件中，或者从文件中读取数据作为进程的输入。

在 C 语言中，I/O 重定向由标准库函数进行管理。常用的重定向操作包括：

- 标准输入重定向到文件：
```C
    freopen("input.txt", "r", stdin); 
```
这种方式将文件 input.txt 中的内容作为程序的输入，而不是从控制台（标准输入）获取输入。

- 标准输出重定向到文件：
```C
    freopen("output.txt", "w", stdout);
```
这种方式将程序输出的内容写入到文件 output.txt 中，而不是输出到控制台（标准输出）。

- 错误输出重定向到文件：
```C
    freopen("error.txt", "w", stderr);
```
这种方式将程序的错误信息输出到文件 error.txt 中，而不是输出到控制台（标准错误输出）。

以上三种方式都是将一个文件（或设备）与标准输入、标准输出、标准错误输出相关联。

此外，还可以使用管道（pipe）将一个进程的输出与另一个进程的输入相连，实现进程间的通信。管道会在内存中开辟一个缓存区，用于存储前一个进程的输出结果，作为后一个进程的输入来源。在 UNIX 系统中，管道使用竖线符号（|）来表示，例如：
```sh
  $ ls | grep "txt"
```
这条命令将 ls 命令的输出结果传递给 grep 命令进行模式匹配搜索，搜索结果输出到控制台上。

总之，I/O 重定向是 UNIX 系统和 C 语言中重要的基础概念之一，在编写各种应用程序时都需要使用。熟练掌握 I/O 重定向和文件描述符等概念，可以帮助我们更加灵活地编写程序，提高程序的兼容性和/或安全性。