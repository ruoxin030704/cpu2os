## 3.1 RISC-V 處理器的組合語言

RISC-V 處理器可以使用組合語言進行程式開發。相對於高階語言，組合語言更加接近硬體層面，可以更方便地進行底層控制和優化。

RISC-V 的組合語言具有以下特點：

- 指令集簡單：RISC-V 的指令集非常簡單，共有不到 50 條指令，不同指令之間的差異也非常小。這使得 RISC-V 的組合語言易於學習和使用。
- 通用寄存器：RISC-V 有 32 個通用寄存器，可以用來暫存數據或地址。這些寄存器都是 32 位的，可以直接進行位運算。
- 指令格式統一：RISC-V 的指令格式統一為 32 位，並且都以 4 位功能碼開始。這種統一的格式使得指令的解碼和執行更加高效。
- 指令操作可視化：RISC-V 的指令操作可以通過顯示器直接可視化，便於程序員進行調試和優化。

下面是一些常用的 RISC-V 指令：

- `add`：將兩個數字相加，結果存儲到目的寄存器中。
- `sub`：將兩個數字相減，結果存儲到目的寄存器中。
- `lw`：從內存中讀取一個字（32 位），並存儲到目的寄存器中。
- `sw`：將一個字（32 位）存儲到內存中。
- `beq`：如果兩個寄存器的值相等，就跳轉到目標地址。
- `bne`：如果兩個寄存器的值不相等，就跳轉到目標地址。

組合語言除了直接使用這些指令外，還可以使用伪指令（pseudo-instruction）來進行進一步的優化和簡化。伪指令是組合語言中的一種特殊指令，它看起來像一條指令，但實際上是由多條指令組合而成的。

例如，`li` 伪指令可以用來將一個數字加載到寄存器中。在實際實現中，`li` 指令是由一條 `auipc` 指令和一條 `addi` 指令組合而成的。下面是 `li` 指令的用法：

```
li a0, 100  # 將 100 加載到 a0 寄存器中
```

在組合語言開發時，還需要進行手動的內存管理和堆棧管理。這些管理操作通常涉及到特定地址或寄存器。以下是一些常用的內存和堆棧管理指令：

- `la`：將一個地址加載到寄存器中。
- `li`：將一個整數加載到寄存器中。
- `mv`：將一個寄存器中的值移動到另一個寄存器中。
- `addi`：將一個整數加到寄存器中。
- `jal`：跳轉到目標地址，同時將下一條指令的地址存儲到 ra（返回地址）寄存器中。
- `jr`：跳轉到寄存器中存儲的地址。

組合語言程式的開發和調試需要使用特定的工具，例如編譯器、調試器和仿真器等。在進行組合語言開發之前，需要先熟悉 RISC-V 的指令集和硬體結構，了解如何進行內存和堆棧管理等操作。